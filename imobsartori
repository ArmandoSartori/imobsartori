<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Imobiliária</title>
  <style>
    body { font-family: sans-serif; margin: 0; background: #dbe9df; color: #0f1a14; }
    header { background: #3b6b4a; color: white; padding: 1rem; display: flex; justify-content: space-between; align-items: center; }
    header .brand { display: flex; align-items: center; gap: 0.5rem; }
    header nav button { margin-left: 0.5rem; padding: 0.3rem 0.7rem; border-radius: 0.3rem; background: rgba(255,255,255,0.1); border: none; color: white; cursor: pointer; }
    main { padding: 1rem; max-width: 1200px; margin: auto; }
    footer { text-align: center; padding: 1rem; color: #555; }
    .listing-card { border: 1px solid #ccc; background: white; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem; display: flex; flex-direction: column; }
    .listing-card h3 { margin: 0; font-weight: bold; }
    .listing-card .price { color: gray; font-size: 0.9rem; }
    .listing-card .city { font-size: 0.85rem; margin-top: 0.3rem; }
    .listing-card p { font-size: 0.85rem; margin-top: 0.5rem; flex: 1; }
    .listing-card button { padding: 0.3rem 0.6rem; border: none; border-radius: 0.3rem; color: white; cursor: pointer; margin-right: 0.3rem; font-size: 0.8rem; }
    .edit-btn { background: #f59e0b; }
    .remove-btn { background: #dc2626; }
    .form-group { margin-bottom: 0.7rem; }
    input, textarea, select { width: 100%; padding: 0.3rem; border-radius: 0.3rem; border: 1px solid #ccc; }
    .form-buttons button { margin-right: 0.5rem; }
    .add-btn { background: #16a34a; color: white; border: none; padding: 0.4rem 0.8rem; border-radius: 0.3rem; cursor: pointer; }
    .cancel-btn { background: white; border: 1px solid #ccc; padding: 0.4rem 0.8rem; border-radius: 0.3rem; cursor: pointer; }
  </style>
</head>
<body>
  <header>
    <div class="brand">
      <div style="width:48px;height:48px;background:#29482f;display:flex;align-items:center;justify-content:center;font-weight:bold;">IM</div>
      <div>
        <div>Imobiliária</div>
        <div style="font-size:0.8rem;">Catálogo simples</div>
      </div>
    </div>
    <nav>
      <button onclick="showTab('listings')">Imóveis</button>
      <button onclick="showTab('add')">Adicionar</button>
      <button onclick="showTab('about')">Sobre</button>
    </nav>
  </header>

  <main>
    <div id="listings-tab">
      <div style="display:flex; gap:0.5rem; margin-bottom:1rem;">
        <select id="cityFilter" onchange="renderListings()"></select>
        <input type="text" id="search" placeholder="Buscar..." oninput="renderListings()" style="flex:1">
      </div>
      <div id="listings-container"></div>
    </div>

    <div id="add-tab" style="display:none; max-width:600px;">
      <h2 id="form-title">Adicionar imóvel</h2>
      <form id="listing-form">
        <div class="form-group">
          <label>Título</label>
          <input name="title" required>
        </div>
        <div class="form-group">
          <label>Cidade</label>
          <input name="city" required>
        </div>
        <div class="form-group">
          <label>Preço</label>
          <input name="price" type="number">
        </div>
        <div class="form-group">
          <label>Descrição</label>
          <textarea name="description" rows="3"></textarea>
        </div>
        <div class="form-buttons">
          <button type="submit" class="add-btn">Salvar</button>
          <button type="button" class="cancel-btn" onclick="cancelEdit()">Cancelar</button>
        </div>
      </form>
    </div>

    <div id="about-tab" style="display:none;">
      <div style="background:white; padding:1rem; border-radius:0.5rem;">
        <h2>Sobre</h2>
        <p style="margin-top:0.5rem; font-size:0.9rem;">Demo simples de catálogo de imóveis. Armazenamento local via localStorage.</p>
      </div>
    </div>
  </main>

  <footer>© Imobiliária - Exemplo</footer>

  <script>
    // ---------- util ----------
    function genId() {
      return Date.now().toString(36) + Math.random().toString(36).slice(2, 8);
    }

    function getListings() {
      const raw = localStorage.getItem("imobiliaria_listings_v1");
      if (raw) return JSON.parse(raw);
      const sample = [
        { id: genId(), title: "Apartamento ensolarado perto do parque", description: "2 quartos, 1 banheiro, cozinha americana. Boa ventilação.", city: "São Paulo", price: 420000 },
        { id: genId(), title: "Casa de esquina com quintal", description: "3 quartos, amplo quintal e garagem para 2 carros.", city: "Campinas", price: 650000 },
        { id: genId(), title: "Studio moderno no centro", description: "Pronto para morar, perto de transporte e comércio.", city: "São Paulo", price: 280000 },
      ];
      localStorage.setItem("imobiliaria_listings_v1", JSON.stringify(sample));
      return sample;
    }

    function saveListings(listings) {
      localStorage.setItem("imobiliaria_listings_v1", JSON.stringify(listings));
    }

    // ---------- estado ----------
    let listings = getListings();
    let editing = null;

    // ---------- tabs ----------
    function showTab(tab) {
      document.getElementById('listings-tab').style.display = tab==='listings'?'block':'none';
      document.getElementById('add-tab').style.display = tab==='add'?'block':'none';
      document.getElementById('about-tab').style.display = tab==='about'?'block':'none';
      if(tab==='add') fillForm(editing || {});
    }

    // ---------- formulário ----------
    function fillForm(item){
      const form = document.getElementById('listing-form');
      form.title.value = item.title || '';
      form.city.value = item.city || '';
      form.price.value = item.price || '';
      form.description.value = item.description || '';
      document.getElementById('form-title').innerText = item.id ? 'Editar imóvel' : 'Adicionar imóvel';
    }

    function cancelEdit(){
      editing = null;
      fillForm({});
      showTab('listings');
    }

    document.getElementById('listing-form').onsubmit = function(e){
      e.preventDefault();
      const form = e.target;
      const data = {
        title: form.title.value,
        city: form.city.value,
        price: Number(form.price.value || 0),
        description: form.description.value
      };
      if(editing && editing.id){
        listings = listings.map(l => l.id === editing.id ? {...l, ...data} : l);
        editing = null;
      } else {
        listings.unshift({id: genId(), ...data});
      }
      saveListings(listings);
      fillForm({});
      showTab('listings');
      renderListings();
    }

    // ---------- listagens ----------
    function renderListings() {
      const container = document.getElementById('listings-container');

      // atualizar select de cidades
      const cities = ['Todas', ...Array.from(new Set(listings.map(l=>l.city)))];
      const select = document.getElementById('cityFilter');
      const current = select.value || 'Todas';
      select.innerHTML='';
      cities.forEach(c=>{
        const option = document.createElement('option');
        option.value=c;
        option.text=c;
        if(c===current) option.selected=true;
        select.appendChild(option);
      });

      const cityFilter = select.value;
      const search = document.getElementById('search').value.toLowerCase();

      const filtered = listings.filter(l=>{
        if(cityFilter !== 'Todas' && l.city !== cityFilter) return false;
        if(search && !(`${l.title} ${l.description} ${l.city}`.toLowerCase().includes(search))) return false;
        return true;
      });

      container.innerHTML='';
      if(filtered.length===0){
        container.innerHTML='<div style="padding:1rem; background:white; border-radius:0.3rem;">Nenhum imóvel encontrado.</div>';
      }

      filtered.forEach(item=>{
        const div = document.createElement('div');
        div.className='listing-card';
        div.innerHTML = `
          <div style="display:flex; justify-content:space-between; align-items:start;">
            <h3>${item.title}</h3>
            <div class="price">R$ ${Number(item.price).toLocaleString('pt-BR')}</div>
          </div>
          <div class="city">${item.city}</div>
          <p>${item.description}</p>
          <div style="margin-top:0.5rem;">
            <button class="edit-btn">Editar</button>
            <button class="remove-btn">Remover</button>
          </div>
        `;
        const [editBtn, removeBtn] = div.querySelectorAll('button');
        editBtn.addEventListener('click', () => startEdit(item.id));
        removeBtn.addEventListener('click', () => removeListing(item.id));
        container.appendChild(div);
      });
    }

    function removeListing(id){
      if(!confirm("Remover este imóvel?")) return;
      listings = listings.filter(l=>l.id!==id);
      saveListings(listings);
      renderListings();
    }

    function startEdit(id){
      editing = listings.find(l=>l.id===id);
      showTab('add');
    }

    // ---------- inicialização ----------
    renderListings();
  </script>
</body>
</html>
